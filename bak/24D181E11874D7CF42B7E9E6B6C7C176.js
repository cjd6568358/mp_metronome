Object.defineProperty(exports,"__esModule",{value:!0}),exports.convertTimeRangeToTimestamp=o,exports.default=void 0;var e=require("@babel/runtime/helpers/slicedToArray.js"),t=require("@babel/runtime/helpers/objectSpread2.js"),a=require("@babel/runtime/helpers/toConsumableArray.js"),r=require("50B40F501874D7CF36D267574997C176.js"),n=require("927AB8341874D7CFF41CD033B558C176.js");function i(e){var r=e.firstDate,i=e.lastDate,o=e.startTimestamp,l=e.endTimestamp,d=e.selectedDate;return n.dateUtil.getTimeStamp(r)>o&&(d=function e(){for(var r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},i=arguments.length>1?arguments[1]:void 0,o=arguments.length>2?arguments[2]:void 0,l=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],d=a(l),s=n.dateUtil.sortDatesByTime(n.dateUtil.calcDates(r.year,r.month),"desc"),m=s.length,g=n.dateUtil.getTimeStamp(s[0]),h=0;h<m;h++){var u=s[h],c=n.dateUtil.getTimeStamp(u);c>=i&&c<=o&&d.push(t(t({},u),{},{choosed:!0})),h===m-1&&g>i&&(d=e(n.dateUtil.getPrevMonthInfo(u),i,o,d))}return d}(n.dateUtil.getPrevMonthInfo(r),o,l,d)),n.dateUtil.getTimeStamp(i)<l&&(d=function e(){for(var r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},i=arguments.length>1?arguments[1]:void 0,o=arguments.length>2?arguments[2]:void 0,l=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],d=a(l),s=n.dateUtil.calcDates(r.year,r.month),m=s.length,g=0;g<m;g++){var h=s[g],u=n.dateUtil.getTimeStamp(h);u<=o&&u>=i&&d.push(t(t({},h),{},{choosed:!0})),g===m-1&&u<o&&(d=e(n.dateUtil.getNextMonthInfo(h),i,o,d))}return d}(n.dateUtil.getNextMonthInfo(i),o,l,d)),a(d)}function o(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=e[0].split("-"),a=e[1].split("-");if(3!==t.length||3!==a.length)return n.logger.warn('enableArea() 参数格式为: ["2018-2-1", "2018-3-1"]'),{};var r=n.dateUtil.newDate(t[0],t[1],t[2]).getTime(),i=n.dateUtil.newDate(a[0],a[1],a[2]).getTime();return{start:t,end:a,startTimestamp:r,endTimestamp:i}}function l(e){var t=o(e),a=t.start,r=t.end,i=t.startTimestamp,l=t.endTimestamp;if(a&&r){var d=n.dateUtil.getDatesCountOfMonth(a[0],a[1]),s=n.dateUtil.getDatesCountOfMonth(r[0],r[1]);return a[2]>d||a[2]<1?(n.logger.warn("enableArea() 开始日期错误，指定日期不在当前月份天数范围内"),!1):a[1]>12||a[1]<1?(n.logger.warn("enableArea() 开始日期错误，月份超出1-12月份"),!1):r[2]>s||r[2]<1?(n.logger.warn("enableArea() 截止日期错误，指定日期不在当前月份天数范围内"),!1):r[1]>12||r[1]<1?(n.logger.warn("enableArea() 截止日期错误，月份超出1-12月份"),!1):!(i>l)||(n.logger.warn("enableArea()参数最小日期大于了最大日期"),!1)}}exports.default=function(){return{name:"timeRange",beforeRender:function(){var a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},o=a.chooseAreaTimestamp,l=void 0===o?[]:o,d=a.dates,s=void 0===d?[]:d,m=a.selectedDates,g=void 0===m?[]:m,h=s,u=g,c=e(l,2),p=c[0],v=c[1];if(2===l.length){u=[],h=s.map((function(e){var a=t({},e),r=n.dateUtil.getTimeStamp(a);return r>=p&&v>=r?(a.choosed=!0,u.push(a)):(a.choosed=!1,u=u.filter((function(e){return n.dateUtil.getTimeStamp(e)!==r}))),a}));var f=n.dateUtil.formatTimestamp(p),T=f.year,U=f.month,D=n.dateUtil.formatTimestamp(v),A=D.year,b=D.month;U===b&&T===A||(u=i({firstDate:h[0],lastDate:h[h.length-1],startTimestamp:p,endTimestamp:v,selectedDate:u}))}return{calendarData:t(t({},a),{},{dates:h,selectedDates:n.dateUtil.sortDatesByTime(n.dateUtil.uniqueArrayByDate(u))}),calendarConfig:r}},onTapDate:function(r){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(!o.chooseAreaMode)return{calendarData:i,calendarConfig:o};var l=i.tempChooseAreaTimestamp,d=void 0===l?[]:l,s=i.chooseAreaTimestamp,m=void 0===s?[]:s,g=i.selectedDates,h=void 0===g?[]:g,u=i.dates,c=void 0===u?[]:u,p=n.dateUtil.getTimeStamp(r),v=a(c),f=a(h);if(2===d.length||2===m.length)d=[r],f=[],v.forEach((function(e){return e.choosed=!1}));else if(1===d.length){var T=d[0],U=n.dateUtil.getTimeStamp(T);U<=p?d.push(r):U>p&&d.unshift(r)}else d=[r];var D=[];if(2===d.length){var A=d,b=e(A,2),C=b[0],S=b[1],y=n.dateUtil.getTimeStamp(C),M=n.dateUtil.getTimeStamp(S);D=[y,M]}return{calendarData:t(t({},i),{},{chooseAreaTimestamp:D,tempChooseAreaTimestamp:d,dates:v,selectedDates:f}),calendarConfig:t(t({},o),{},{multi:!0})}},methods:function(e){return{chooseDateArea:function(){var a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];if(1===a.length&&(a=a.concat(a)),2===a.length){var i=l(a);if(i){var d=(0,n.getCalendarConfig)(e)||{},s=o(a),m=s.startTimestamp,g=s.endTimestamp,h=(0,n.getCalendarData)("calendar",e);return r.renderCalendar.call(e,t(t({},h),{},{chooseAreaTimestamp:[m,g]}),t(t({},d),{},{multi:!0,chooseAreaMode:!0}))}}}}}}};